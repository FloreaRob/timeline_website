<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Album - Music Timeline</title>

  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/main.css">

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <style>
    .admin-page {
      max-width: 800px;
      margin: 0 auto;
      padding: var(--space-xl);
      min-height: calc(100vh - 80px);
    }

    .admin-header {
      text-align: center;
      margin-bottom: var(--space-2xl);
    }

    .admin-header h1 {
      font-size: var(--font-size-2xl);
      color: var(--color-accent-primary);
      margin-bottom: var(--space-sm);
    }

    .admin-header p {
      color: var(--color-text-muted);
    }

    .admin-form {
      background-color: var(--color-surface);
      border-radius: var(--radius-xl);
      padding: var(--space-2xl);
      box-shadow: var(--shadow-lg);
    }

    .image-upload-section {
      margin-bottom: var(--space-xl);
      text-align: center;
    }

    .image-preview-container {
      position: relative;
      display: inline-block;
      margin-bottom: var(--space-md);
    }

    .image-preview {
      max-width: 300px;
      max-height: 300px;
      width: auto;
      height: auto;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      display: none;
    }

    .image-preview.show {
      display: block;
    }

    .image-placeholder {
      width: 300px;
      height: 300px;
      border: 2px dashed var(--color-timeline-axis);
      border-radius: var(--radius-lg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: var(--color-text-muted);
      font-size: var(--font-size-lg);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .image-placeholder:hover {
      border-color: var(--color-accent-primary);
      background-color: var(--color-surface-hover);
    }

    .image-placeholder.hidden {
      display: none;
    }

    .file-input {
      display: none;
    }

    .upload-progress {
      width: 100%;
      max-width: 300px;
      height: 8px;
      background-color: var(--color-surface-hover);
      border-radius: var(--radius-full);
      overflow: hidden;
      margin-top: var(--space-md);
      display: none;
    }

    .upload-progress.show {
      display: block;
    }

    .upload-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--color-accent-primary), var(--color-accent-secondary));
      width: 0%;
      transition: width 0.3s ease;
    }

    .date-inputs {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: var(--space-md);
    }

    .success-message {
      background-color: rgba(29, 185, 84, 0.1);
      border: 2px solid var(--color-success);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      margin-top: var(--space-xl);
      text-align: center;
      display: none;
    }

    .success-message.show {
      display: block;
      animation: slideUp 0.3s ease-out;
    }

    .success-message h3 {
      color: var(--color-success);
      margin-bottom: var(--space-sm);
    }

    .success-actions {
      display: flex;
      gap: var(--space-sm);
      justify-content: center;
      margin-top: var(--space-md);
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <a href="timeline.html" class="btn btn-ghost">
        ‚Üê Back to Timeline
      </a>
    </div>

    <div class="header-actions">
      <div id="userInfo" class="user-info" style="display: none;">
        <span>üë§ <span id="userName"></span></span>
      </div>
      <button id="logoutButton" class="btn btn-ghost">
        Logout
      </button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="admin-page">

    <div class="admin-header">
      <h1>Add New Album or Song</h1>
      <p>Fill in the details below to add to your music timeline</p>
    </div>

    <div class="admin-form">
      <form id="addAlbumForm">

        <!-- Image URL Input -->
        <div class="image-upload-section">
          <label class="form-label">Album/Song Cover Image (Optional)</label>

          <div class="form-group">
            <input
              type="url"
              id="imageUrl"
              name="imageUrl"
              placeholder="Paste image URL (optional - leave blank for default üéµ icon)"
            >
            <small class="text-muted" style="display: block; margin-top: var(--space-xs);">
              üí° Upload your image to <a href="https://imgur.com/upload" target="_blank" style="color: var(--color-accent-primary);">Imgur</a>
              or any image hosting service, then paste the direct link here
            </small>
          </div>

          <div class="image-preview-container">
            <img id="imagePreview" class="image-preview" src="" alt="Preview">
            <div id="imagePlaceholder" class="image-placeholder">
              <span style="font-size: 48px; margin-bottom: var(--space-sm);">üì∏</span>
              <span>Image preview will appear here</span>
            </div>
          </div>
        </div>

        <!-- Title -->
        <div class="form-group">
          <label for="title" class="form-label">Title *</label>
          <input
            type="text"
            id="title"
            name="title"
            placeholder="Enter album or song name"
            required
          >
        </div>

        <!-- Type -->
        <div class="form-group">
          <label for="type" class="form-label">Type *</label>
          <select id="type" name="type" required>
            <option value="">Select type</option>
            <option value="album">Album</option>
            <option value="song">Song</option>
          </select>
        </div>

        <!-- Release Date -->
        <div class="form-group">
          <label class="form-label">Release Date *</label>
          <div class="date-inputs">
            <select id="month" name="month" required>
              <option value="">Select month</option>
              <option value="1">January</option>
              <option value="2">February</option>
              <option value="3">March</option>
              <option value="4">April</option>
              <option value="5">May</option>
              <option value="6">June</option>
              <option value="7">July</option>
              <option value="8">August</option>
              <option value="9">September</option>
              <option value="10">October</option>
              <option value="11">November</option>
              <option value="12">December</option>
            </select>

            <input
              type="number"
              id="year"
              name="year"
              placeholder="Year"
              min="1900"
              max="2100"
              required
            >
          </div>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary btn-block" id="submitButton">
          <span id="submitButtonText">Add to Timeline</span>
          <span id="submitSpinner" class="spinner-small hidden"></span>
        </button>

      </form>

      <!-- Success Message -->
      <div id="successMessage" class="success-message">
        <h3>‚úì Album Added Successfully!</h3>
        <p id="addedAlbumTitle"></p>
        <div class="success-actions">
          <button class="btn btn-primary" id="addAnotherBtn">
            + Add Another
          </button>
          <a href="timeline.html" class="btn btn-secondary">
            View Timeline
          </a>
        </div>
      </div>
    </div>

  </main>

  <!-- Scripts -->
  <script src="js/firebase-config.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/admin.js"></script>

</body>
</html>
